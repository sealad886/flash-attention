# Manual workflow to build MLX wheels
#
# NOTE: GitHub-hosted macOS runners are virtualized and do NOT have Metal GPU access.
# The build will succeed but GPU verification is limited to import tests only.
# For full GPU testing, use a self-hosted Apple Silicon runner.

name: Build MLX wheels

on:
  workflow_dispatch:
    inputs:
      runs-on:
        description: "The runner to use for the build (arm64/Apple Silicon)"
        required: true
        type: choice
        options:
          - macos-26
        default: macos-26
      python-version:
        description: "The Python version to use for the build"
        required: true
        type: choice
        options:
          - "3.10"
          - "3.11"
          - "3.12"
          - "3.13"
        default: "3.11"
      upload-to-release:
        description: "Upload wheel to a release"
        required: false
        type: boolean
        default: false
      release-version:
        description: "Upload wheel to this release (tag)"
        required: false
        type: string

jobs:
  build-mlx-wheel:
    uses: ./.github/workflows/_build_mlx.yml
    with:
      runs-on: ${{ inputs.runs-on }}
      python-version: ${{ inputs.python-version }}
      upload-to-release: ${{ inputs.upload-to-release }}
      release-version: ${{ inputs.release-version }}
